<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Contest Management - WhatsApp Bulk Message</title>

  <style>
    /* ===== Modern Contest Management Design ===== */
    :root{
      --primary:#1877f2; --primary-hover:#166fe5; --primary-light:#e7f3ff;
      --secondary:#42b883; --secondary-hover:#3aa876; --secondary-light:#e8f5e8;
      --success:#42b883; --warning:#f7b731; --danger:#e74c3c; --info:#17a2b8;
      --gray:#f0f2f5; --gray-dark:#65676b; --gray-light:#f8f9fa;
      --white:#ffffff; --black:#1c1e21; --text:#1c1e21;
      --border:#dadde1; --shadow:0 2px 4px rgba(0,0,0,0.1), 0 8px 16px rgba(0,0,0,0.1);
      --radius:8px; --radius-lg:12px;
    }
    *{box-sizing:border-box; margin:0; padding:0}
    body{background:var(--gray); color:var(--text); font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif; line-height:1.4}

    /* ===== Top Navigation ===== */
    .topbar{
      background:var(--white); border-bottom:1px solid var(--border);
      position:sticky; top:0; z-index:1000; box-shadow:0 1px 2px rgba(0,0,0,0.1)
    }
    .topbar__inner{
      max-width:1200px; margin:0 auto; display:flex; align-items:center; justify-content:space-between;
      padding:8px 16px; height:56px
    }
    .brand{
      display:flex; align-items:center; gap:8px; text-decoration:none; font-weight:700; font-size:20px
    }
    .brand__logo{
      width:40px; height:40px; border-radius:50%; background:var(--primary);
      display:flex; align-items:center; justify-content:center; color:white; font-weight:800
    }
    .brand__text{color:var(--text)}

    .nav-tabs{
      display:flex; gap:8px; align-items:center; flex:1; justify-content:center
    }
    .nav-tab{
      padding:8px 16px; border-radius:var(--radius); text-decoration:none; font-weight:600;
      color:var(--gray-dark); transition:all 0.2s; position:relative
    }
    .nav-tab:hover{background:var(--gray-light); color:var(--text)}
    .nav-tab.active{color:var(--primary); background:var(--primary-light)}

    .user-menu{
      display:flex; align-items:center; gap:12px
    }
    .user-avatar{
      width:32px; height:32px; border-radius:50%; background:var(--primary);
      display:flex; align-items:center; justify-content:center; color:white; font-weight:600
    }

    /* ===== Main Content ===== */
    .main-content{
      max-width:1200px; margin:0 auto; padding:24px 16px
    }

    /* ===== Page Header ===== */
    .page-header{
      display:flex; justify-content:space-between; align-items:center; margin-bottom:24px
    }
    .page-title{
      font-size:28px; font-weight:700; color:var(--text)
    }
    .btn{
      padding:10px 20px; border-radius:var(--radius); text-decoration:none; font-weight:600;
      transition:all 0.2s; border:none; cursor:pointer; display:inline-flex; align-items:center; gap:8px
    }
    .btn-primary{
      background:var(--primary); color:white
    }
    .btn-primary:hover{background:var(--primary-hover); color:white}
    .btn-secondary{
      background:var(--secondary); color:white
    }
    .btn-secondary:hover{background:var(--secondary-hover); color:white}

    /* ===== Contest Cards ===== */
    .contests-grid{
      display:grid; grid-template-columns:repeat(auto-fit, minmax(350px, 1fr)); gap:20px; margin-bottom:32px
    }
    .contest-card{
      background:var(--white); border-radius:var(--radius-lg); padding:24px; box-shadow:var(--shadow);
      border:1px solid var(--border); transition:all 0.2s
    }
    .contest-card:hover{transform:translateY(-2px); box-shadow:0 4px 12px rgba(0,0,0,0.15)}
    
    .contest-header{
      display:flex; justify-content:space-between; align-items:flex-start; margin-bottom:16px
    }
    .contest-title{
      font-size:20px; font-weight:700; color:var(--text); margin-bottom:4px
    }
    .contest-status{
      padding:4px 12px; border-radius:20px; font-size:12px; font-weight:600; text-transform:uppercase
    }
    .status-active{background:var(--secondary-light); color:var(--secondary)}
    .status-upcoming{background:var(--info); color:white}
    .status-ended{background:var(--gray-light); color:var(--gray-dark)}

    .contest-description{
      color:var(--gray-dark); margin-bottom:16px; line-height:1.5
    }

    .contest-stats{
      display:grid; grid-template-columns:repeat(2, 1fr); gap:16px; margin-bottom:16px
    }
    .stat-item{
      text-align:center; padding:12px; background:var(--gray-light); border-radius:var(--radius)
    }
    .stat-number{
      font-size:24px; font-weight:700; color:var(--text)
    }
    .stat-label{
      font-size:12px; color:var(--gray-dark); text-transform:uppercase; font-weight:600
    }

    .contest-actions{
      display:flex; gap:8px; flex-wrap:wrap
    }
    .btn-sm{
      padding:6px 12px; font-size:14px
    }

    /* ===== Active Contest Highlight ===== */
    .active-contest{
      background:linear-gradient(135deg, var(--primary-light) 0%, var(--secondary-light) 100%);
      border:2px solid var(--primary)
    }
    .active-contest .contest-title{color:var(--primary)}

    /* ===== Quick Stats ===== */
    .quick-stats{
      display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:20px; margin-bottom:32px
    }
    .stat-card{
      background:var(--white); border-radius:var(--radius-lg); padding:20px; box-shadow:var(--shadow);
      text-align:center; border:1px solid var(--border)
    }
    .stat-card-icon{
      width:48px; height:48px; border-radius:50%; margin:0 auto 12px; display:flex;
      align-items:center; justify-content:center; font-size:24px
    }
    .stat-card-icon.primary{background:var(--primary-light); color:var(--primary)}
    .stat-card-icon.success{background:var(--secondary-light); color:var(--secondary)}
    .stat-card-icon.warning{background:var(--warning); color:white}
    .stat-card-icon.info{background:var(--info); color:white}

    /* ===== Empty State ===== */
    .empty-state{
      text-align:center; padding:60px 20px; background:var(--white); border-radius:var(--radius-lg);
      box-shadow:var(--shadow); border:1px solid var(--border)
    }
    .empty-state-icon{
      width:80px; height:80px; border-radius:50%; background:var(--gray-light);
      display:flex; align-items:center; justify-content:center; margin:0 auto 20px; font-size:40px; color:var(--gray-dark)
    }
    .empty-state-title{
      font-size:24px; font-weight:700; color:var(--text); margin-bottom:8px
    }
    .empty-state-text{
      color:var(--gray-dark); margin-bottom:24px; max-width:400px; margin-left:auto; margin-right:auto
    }

    /* ===== Responsive ===== */
    @media (max-width: 768px){
      .contests-grid{grid-template-columns:1fr}
      .quick-stats{grid-template-columns:repeat(2, 1fr)}
      .page-header{flex-direction:column; align-items:stretch; gap:16px}
      .contest-stats{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <!-- Top Navigation -->
  <div class="topbar">
    <div class="topbar__inner">
      <a href="{% url 'contest_home' %}" class="brand">
        <div class="brand__logo">W</div>
        <span class="brand__text">WhatsApp Contest</span>
      </a>
      
      <div class="nav-tabs">
        <a href="{% url 'contest_home' %}" class="nav-tab active">Contest</a>
        <a href="{% url 'crm_home' %}" class="nav-tab">CRM</a>
        <a href="{% url 'manage_customers' %}" class="nav-tab">Customers</a>
      </div>
      
      <div class="user-menu">
        <div class="user-avatar">{{ user.username|first|upper }}</div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Page Header -->
    <div class="page-header">
      <h1 class="page-title">Contest Management</h1>
      <a href="{% url 'contest_create' %}" class="btn btn-primary">
        <span>+</span> Create New Contest
      </a>
    </div>

    <!-- Quick Stats -->
    <div class="quick-stats">
      <div class="stat-card">
        <div class="stat-card-icon primary">üèÜ</div>
        <div class="stat-number">{{ contests|length }}</div>
        <div class="stat-label">Total Contests</div>
      </div>
      <div class="stat-card">
        <div class="stat-card-icon success">‚úÖ</div>
        <div class="stat-number">
          {% if active_contest %}{{ active_contest.verified_entries }}{% else %}0{% endif %}
        </div>
        <div class="stat-label">Verified Entries</div>
      </div>
      <div class="stat-card">
        <div class="stat-card-icon warning">‚è≥</div>
        <div class="stat-number">
          {% if active_contest %}{{ active_contest.entries.filter.status='pending'|length }}{% else %}0{% endif %}
        </div>
        <div class="stat-label">Pending Review</div>
      </div>
      <div class="stat-card">
        <div class="stat-card-icon info">üëë</div>
        <div class="stat-number">
          {% if active_contest %}{{ active_contest.entries.filter.is_winner=True|length }}{% else %}0{% endif %}
        </div>
        <div class="stat-label">Winners</div>
      </div>
    </div>

    <!-- Contests Grid -->
    {% if contests %}
      <div class="contests-grid">
        {% for contest in contests %}
          <div class="contest-card {% if contest.is_currently_active %}active-contest{% endif %}">
            <div class="contest-header">
              <div>
                <h3 class="contest-title">{{ contest.name }}</h3>
                <div class="contest-status 
                  {% if contest.is_currently_active %}status-active
                  {% elif contest.starts_at > now %}status-upcoming
                  {% else %}status-ended{% endif %}">
                  {% if contest.is_currently_active %}Active
                  {% elif contest.starts_at > now %}Upcoming
                  {% else %}Ended{% endif %}
                </div>
              </div>
            </div>
            
            <p class="contest-description">{{ contest.description|truncatechars:100 }}</p>
            
            <div class="contest-stats">
              <div class="stat-item">
                <div class="stat-number">{{ contest.total_entries }}</div>
                <div class="stat-label">Total Entries</div>
              </div>
              <div class="stat-item">
                <div class="stat-number">{{ contest.verified_entries }}</div>
                <div class="stat-label">Verified</div>
              </div>
            </div>
            
            <div class="contest-actions">
              <a href="{% url 'contest_detail' contest.contest_id %}" class="btn btn-primary btn-sm">
                View Details
              </a>
              <a href="{% url 'contest_analytics' %}?contest_id={{ contest.contest_id }}" class="btn btn-secondary btn-sm">
                Analytics
              </a>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <!-- Empty State -->
      <div class="empty-state">
        <div class="empty-state-icon">üèÜ</div>
        <h2 class="empty-state-title">No Contests Yet</h2>
        <p class="empty-state-text">
          Create your first contest to start collecting entries and engaging with customers through WhatsApp.
        </p>
        <a href="{% url 'contest_create' %}" class="btn btn-primary">
          Create Your First Contest
        </a>
      </div>
    {% endif %}
  </div>
</body>
</html>
