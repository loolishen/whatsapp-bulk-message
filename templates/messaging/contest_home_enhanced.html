<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="csrf-token" content="{{ csrf_token }}">
  <title>Contest Management - WhatsApp Bulk Message</title>

  <style>
    /* ===== Modern Contest Management Design ===== */
    :root{
      --primary:#1877f2; --primary-hover:#166fe5; --primary-light:#e7f3ff;
      --secondary:#42b883; --secondary-hover:#3aa876; --secondary-light:#e8f5e8;
      --success:#42b883; --warning:#f7b731; --danger:#e74c3c; --info:#17a2b8;
      --gray:#f0f2f5; --gray-dark:#65676b; --gray-light:#f8f9fa;
      --white:#ffffff; --black:#1c1e21; --text:#1c1e21;
      --border:#dadde1; --shadow:0 2px 4px rgba(0,0,0,0.1), 0 8px 16px rgba(0,0,0,0.1);
      --radius:8px; --radius-lg:12px;
      --text-muted:#595959;
    }
    *{box-sizing:border-box; margin:0; padding:0}
    body{background:var(--gray); color:var(--text); font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif; line-height:1.4}

    /* ===== Side Navigation ===== */
    .sidebar{
      position:fixed; top:0; left:0; width:280px; height:100vh;
      background:var(--white); border-right:1px solid var(--border);
      display:flex; flex-direction:column; z-index:1000; box-shadow:2px 0 8px rgba(0,0,0,0.1)
    }

    .sidebar-header{
      padding:24px; border-bottom:1px solid var(--border); text-align:center
    }

    .profile-section{
      display:flex; flex-direction:column; align-items:center; gap:12px
    }

    .profile-avatar{
      width:60px; height:60px; border-radius:50%; background:var(--primary);
      display:flex; align-items:center; justify-content:center; color:white; font-weight:700; font-size:24px
    }

    .profile-name{
      font-size:18px; font-weight:500; color:var(--text); margin:0
    }

    .profile-role{
      font-size:11px; font-weight:300; color:var(--text-muted); margin:0
    }

    .sidebar-nav{
      flex:1; padding:24px 0; overflow-y:auto
    }

    .nav-item{
      display:block; padding:12px 24px; text-decoration:none; font-weight:300;
      color:var(--text-muted); transition:all 0.2s; border-left:3px solid transparent;
      font-size:14px
    }

    .nav-item:hover{
      background:var(--gray-light); color:var(--text); border-left-color:var(--primary)
    }

    .nav-item.active{
      background:var(--primary-light); color:var(--primary); border-left-color:var(--primary);
      font-weight:500
    }

    .nav-item-icon{
      margin-right:12px; font-size:16px
    }

    /* ===== Main Content ===== */
    .main-content{
      margin-left:280px; padding:24px 32px; min-height:100vh
    }

    /* ===== Page Header ===== */
    .page-header{
      display:flex; justify-content:space-between; align-items:center; margin-bottom:24px
    }
    .page-title{
      font-size:28px; font-weight:700; color:var(--text)
    }
    .btn{
      padding:10px 20px; border-radius:var(--radius); text-decoration:none; font-weight:600;
      transition:all 0.2s; border:none; cursor:pointer; display:inline-flex; align-items:center; gap:8px
    }
    .btn-primary{
      background:var(--primary); color:white
    }
    .btn-primary:hover{background:var(--primary-hover); color:white}
    .btn-secondary{
      background:var(--secondary); color:white
    }
    .btn-secondary:hover{background:var(--secondary-hover); color:white}

    /* ===== Contest Cards ===== */
    .contests-grid{
      display:grid; grid-template-columns:repeat(auto-fit, minmax(350px, 1fr)); gap:20px; margin-bottom:32px
    }
    .contest-card{
      background:var(--white); border-radius:var(--radius-lg); padding:24px; box-shadow:var(--shadow);
      border:1px solid var(--border); transition:all 0.2s
    }
    .contest-card:hover{transform:translateY(-2px); box-shadow:0 4px 12px rgba(0,0,0,0.15)}
    
    .contest-header{
      display:flex; justify-content:space-between; align-items:flex-start; margin-bottom:16px
    }
    .contest-title{
      font-size:20px; font-weight:700; color:var(--text); margin-bottom:4px
    }
    .contest-status{
      padding:4px 12px; border-radius:20px; font-size:12px; font-weight:600; text-transform:uppercase
    }
    .status-active{background:var(--secondary-light); color:var(--secondary)}
    .status-upcoming{background:var(--info); color:white}
    .status-ended{background:var(--gray-light); color:var(--gray-dark)}

    .contest-description{
      color:var(--gray-dark); margin-bottom:16px; line-height:1.5
    }

    .contest-stats{
      display:grid; grid-template-columns:repeat(2, 1fr); gap:16px; margin-bottom:16px
    }
    .stat-item{
      text-align:center; padding:12px; background:var(--gray-light); border-radius:var(--radius)
    }
    .stat-number{
      font-size:24px; font-weight:700; color:var(--text)
    }
    .stat-label{
      font-size:12px; color:var(--gray-dark); text-transform:uppercase; font-weight:600
    }

    .contest-actions{
      display:flex; gap:8px; flex-wrap:wrap
    }
    .btn-sm{
      padding:6px 12px; font-size:14px
    }

    /* ===== Active Contest Highlight ===== */
    .active-contest{
      background:linear-gradient(135deg, var(--primary-light) 0%, var(--secondary-light) 100%);
      border:2px solid var(--primary)
    }
    .active-contest .contest-title{color:var(--primary)}

    /* ===== Contest Status Sections ===== */
    .contest-status-sections{
      display:grid; grid-template-columns:repeat(auto-fit, minmax(300px, 1fr)); gap:24px; margin-bottom:32px
    }
    .status-section{
      background:var(--white); border-radius:var(--radius-lg); padding:24px; box-shadow:var(--shadow);
      border:1px solid var(--border)
    }
    .status-header{
      display:flex; justify-content:space-between; align-items:center; margin-bottom:16px;
      padding-bottom:12px; border-bottom:1px solid var(--border)
    }
    .status-title{
      font-size:18px; font-weight:600; color:var(--text); margin:0
    }
    .status-count{
      background:var(--primary-light); color:var(--primary); padding:4px 12px;
      border-radius:20px; font-size:12px; font-weight:600
    }
    .status-content{
      display:flex; flex-direction:column; gap:12px
    }
    .status-item{
      padding:16px; border-radius:var(--radius); border:1px solid var(--border);
      transition:all 0.2s; cursor:pointer
    }
    .status-item:hover{
      background:var(--gray-light); transform:translateY(-1px)
    }
    .status-item.active{
      border-left:4px solid var(--success)
    }
    .status-item.upcoming{
      border-left:4px solid var(--info)
    }
    .status-item.ended{
      border-left:4px solid var(--gray-dark)
    }
    .status-item.flagged{
      border-left:4px solid var(--danger); background:#fef2f2
    }
    .status-item-info{
      margin-bottom:8px
    }
    .status-item-title{
      font-size:16px; font-weight:600; color:var(--text); margin:0 0 4px 0
    }
    .status-item-desc{
      font-size:14px; color:var(--text-muted); margin:0
    }
    .status-item-stats{
      display:flex; gap:8px; flex-wrap:wrap
    }
    .stat-badge{
      background:var(--gray-light); color:var(--text-muted); padding:4px 8px;
      border-radius:12px; font-size:11px; font-weight:500
    }
    .status-item-date{
      display:flex; align-items:center; gap:8px
    }
    .date-label{
      font-size:12px; color:var(--text-muted); font-weight:500
    }
    .date-value{
      font-size:12px; color:var(--text); font-weight:600
    }
    .status-empty{
      text-align:center; padding:20px; color:var(--text-muted); font-style:italic
    }
    .status-item.flagged{
      border-left:4px solid var(--danger)
    }
    .status-item.active{
      border-left:4px solid var(--primary)
    }
    .status-item-date{
      margin-top:8px; padding-top:8px; border-top:1px solid var(--border)
    }

    /* ===== Contest Table ===== */
    .contest-table-section{
      background:var(--white); border-radius:var(--radius-lg); padding:24px; box-shadow:var(--shadow);
      border:1px solid var(--border); margin-bottom:32px
    }
    .table-header{
      margin-bottom:20px; padding-bottom:16px; border-bottom:1px solid var(--border)
    }
    .table-title{
      font-size:20px; font-weight:600; color:var(--text); margin:0 0 4px 0
    }
    .table-subtitle{
      font-size:14px; color:var(--text-muted); margin:0
    }
    .table-container{
      overflow-x:auto; border-radius:var(--radius); border:1px solid var(--border)
    }
    .contest-table{
      width:100%; border-collapse:collapse; font-size:12px
    }
    .contest-table th{
      background:var(--gray-light); color:var(--text); font-weight:600; padding:12px 8px;
      text-align:left; border-bottom:1px solid var(--border); white-space:nowrap
    }
    .contest-table td{
      padding:12px 8px; border-bottom:1px solid var(--border); vertical-align:top;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:200px
    }
    .table-row{
      cursor:pointer; transition:background-color 0.2s
    }
    .table-row:hover{
      background:var(--gray-light)
    }
    
    /* Contest Summary Table Styles */
    .contest-name{
      display:flex; flex-direction:column; gap:4px
    }
    .contest-dates{
      font-size:10px; color:var(--text-muted); font-weight:400
    }
    
    .spending-info{
      display:flex; flex-direction:column; gap:2px
    }
    .spending-amount{
      font-size:14px; font-weight:700; color:var(--primary)
    }
    .spending-detail{
      font-size:10px; color:var(--text-muted)
    }
    
    .products-list, .stores-list, .locations-list{
      display:flex; flex-direction:column; gap:4px
    }
    .product-item, .store-item, .location-item{
      font-size:11px; color:var(--text); padding:2px 0
    }
    
    .entries-info{
      display:flex; flex-direction:column; gap:2px; text-align:center
    }
    .entries-count{
      font-size:16px; font-weight:700; color:var(--primary)
    }
    .entries-detail{
      font-size:10px; color:var(--text-muted)
    }
    
    .status-badge{
      padding:4px 8px; border-radius:12px; font-size:10px; font-weight:600; text-transform:uppercase
    }
    .status-badge.active{
      background:var(--secondary-light); color:var(--secondary)
    }
    .status-badge.ended{
      background:var(--gray-light); color:var(--gray-dark)
    }
    .status-badge.upcoming{
      background:var(--info); color:white
    }
    
    .action-buttons{
      display:flex; gap:4px
    }
    .btn-sm{
      padding:4px 8px; font-size:10px; border-radius:4px
    }

    /* ===== Toggle Switch Styles ===== */
    .contest-name-header{
      display:flex; align-items:center; gap:12px
    }
    .contest-toggle-container{
      flex-shrink:0
    }
    .contest-name-content{
      flex:1
    }
    .toggle-switch{
      position:relative; display:inline-block; width:44px; height:24px
    }
    .toggle-switch input{
      opacity:0; width:0; height:0
    }
    .toggle-slider{
      position:absolute; cursor:pointer; top:0; left:0; right:0; bottom:0;
      background-color:#ccc; transition:0.3s; border-radius:24px
    }
    .toggle-slider:before{
      position:absolute; content:""; height:18px; width:18px; left:3px; bottom:3px;
      background-color:white; transition:0.3s; border-radius:50%
    }
    .toggle-switch input:checked + .toggle-slider{
      background-color:var(--primary)
    }
    .toggle-switch input:checked + .toggle-slider:before{
      transform:translateX(20px)
    }
    .toggle-switch input:disabled + .toggle-slider{
      opacity:0.5; cursor:not-allowed
    }

    /* ===== Empty State ===== */
    .empty-state{
      text-align:center; padding:60px 20px; background:var(--white); border-radius:var(--radius-lg);
      box-shadow:var(--shadow); border:1px solid var(--border)
    }
    .empty-state-icon{
      width:80px; height:80px; border-radius:50%; background:var(--gray-light);
      display:flex; align-items:center; justify-content:center; margin:0 auto 20px; font-size:40px; color:var(--gray-dark)
    }
    .empty-state-title{
      font-size:24px; font-weight:700; color:var(--text); margin-bottom:8px
    }
    .empty-state-text{
      color:var(--gray-dark); margin-bottom:24px; max-width:400px; margin-left:auto; margin-right:auto
    }

    /* ===== Responsive ===== */
    @media (max-width: 1024px){
      .main-content{margin-left:0; padding:24px 16px}
      .sidebar{transform:translateX(-100%); transition:transform 0.3s ease}
      .sidebar.open{transform:translateX(0)}
      .contest-status-sections{grid-template-columns:1fr}
      .table-container{overflow-x:scroll}
    }
    @media (max-width: 768px){
      .page-header{flex-direction:column; align-items:stretch; gap:16px}
      .main-content{padding:16px}
      .contest-table{font-size:10px}
      .contest-table th, .contest-table td{padding:8px 4px}
    }
  </style>
</head>
<body>
  <!-- Side Navigation -->
  <div class="sidebar">
    <div class="sidebar-header">
      <div class="profile-section">
        <div class="profile-avatar">K</div>
        <h3 class="profile-name">Khind</h3>
        <p class="profile-role">Admin</p>
    </div>
    </div>
    
    <nav class="sidebar-nav">
      <a href="{% url 'dashboard' %}" class="nav-item active">
        <span class="nav-item-icon">📊</span>
        Dashboard
      </a>
      <a href="{% url 'contest_create' %}" class="nav-item">
        <span class="nav-item-icon">➕</span>
        Contest Creation
      </a>
      <a href="{% url 'contest_manager' %}" class="nav-item">
        <span class="nav-item-icon">🎯</span>
        Contest Manager
      </a>
      <a href="{% url 'participants_manager' %}" class="nav-item">
        <span class="nav-item-icon">👥</span>
        Participants Manager
      </a>
    </nav>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Page Header -->
    <div class="page-header">
      <h1 class="page-title">Contest Management</h1>
      <a href="{% url 'contest_create' %}" class="btn btn-primary">
        <span>+</span> Create New Contest
      </a>
    </div>

    <!-- Contest Status Sections - First Row -->
    <div class="contest-status-sections">
      <div class="status-section">
        <div class="status-header">
          <h3 class="status-title">Active Contests</h3>
          <span class="status-count">{{ overall_stats.active_contests }}</span>
        </div>
        <div class="status-content">
          {% for contest in contests %}
            {% if contest.is_active %}
              <div class="status-item active {% if contest.flagged_entries > 0 %}flagged{% endif %}">
                <div class="status-item-info">
                  <h4 class="status-item-title">
                    {{ contest.name }}
                    {% if contest.flagged_entries > 0 %}
                      <span style="color: var(--danger); font-size: 12px; margin-left: 8px;">⚠️ {{ contest.flagged_entries }} flagged</span>
                    {% endif %}
                  </h4>
                  <p class="status-item-desc">{{ contest.description|truncatechars:60 }}</p>
                  <div class="status-item-date">
                    <span class="date-label">Duration:</span>
                    <span class="date-value">{{ contest.starts_at|date:"M d" }} - {{ contest.ends_at|date:"M d, Y" }}</span>
                  </div>
                </div>
                <div class="status-item-stats">
                  <span class="stat-badge">{{ contest.total_entries }} entries</span>
                  <span class="stat-badge">{{ contest.verified_entries }} verified</span>
                  {% if contest.flagged_entries > 0 %}
                    <span class="stat-badge" style="background: var(--danger); color: white;">{{ contest.flagged_entries }} flagged</span>
                  {% endif %}
                  <span class="stat-badge" style="background: var(--primary-light); color: var(--primary);">Min: RM{{ contest.min_purchase_amount }}</span>
                </div>
              </div>
            {% endif %}
          {% empty %}
            <div class="status-empty">No active contests</div>
          {% endfor %}
      </div>
        </div>

      <div class="status-section">
        <div class="status-header">
          <h3 class="status-title">Flagged Entries</h3>
          <span class="status-count">{{ overall_stats.total_flagged_entries }}</span>
        </div>
        <div class="status-content">
          {% if overall_stats.total_flagged_entries > 0 %}
            <div class="status-item flagged">
              <div class="status-item-info">
                <h4 class="status-item-title">⚠️ {{ overall_stats.total_flagged_entries }} Flagged Entries</h4>
                <p class="status-item-desc">Entries that require review or have been rejected</p>
              </div>
              <div class="status-item-stats">
                <span class="stat-badge" style="background: var(--danger); color: white;">{{ overall_stats.total_flagged_entries }} flagged</span>
                <span class="stat-badge">{{ overall_stats.total_entries }} total entries</span>
              </div>
            </div>
            
          {% else %}
            <div class="status-empty">No flagged entries</div>
          {% endif %}
        </div>
      </div>

      <div class="status-section">
        <div class="status-header">
          <h3 class="status-title">Overall Contest Stats</h3>
          <span class="status-count">{{ overall_stats.total_contests }}</span>
        </div>
        <div class="status-content">
          <div class="status-item">
            <div class="status-item-info">
              <h4 class="status-item-title">📊 Contest Overview</h4>
              <p class="status-item-desc">Total statistics across all contests</p>
            </div>
            <div class="status-item-stats">
              <span class="stat-badge">{{ overall_stats.total_contests }} contests</span>
              <span class="stat-badge">{{ overall_stats.active_contests }} active</span>
            </div>
          </div>
          
          <div class="status-item">
            <div class="status-item-info">
              <h4 class="status-item-title">📈 Entry Statistics</h4>
              <p class="status-item-desc">Breakdown of all contest entries</p>
            </div>
            <div class="status-item-stats">
              <span class="stat-badge">{{ overall_stats.total_entries }} total</span>
              <span class="stat-badge">{{ overall_stats.total_verified_entries }} verified</span>
              <span class="stat-badge">{{ overall_stats.total_pending_entries }} pending</span>
              <span class="stat-badge">{{ overall_stats.total_winners }} winners</span>
            </div>
          </div>
        </div>
      </div>
    </div>
            
    <!-- Contest Summary Table -->
    <div class="contest-table-section">
      <div class="table-header">
        <h3 class="table-title">Contest Analytics Summary</h3>
        <p class="table-subtitle">Key insights from contest participation data</p>
      </div>
      
      {% if contests %}
        <div class="table-container">
          <table class="contest-table">
            <thead>
              <tr>
                <th>Contest Name</th>
                <th>Average Spending</th>
                <th>Popular Products</th>
                <th>Popular Stores</th>
                <th>Store Locations</th>
                <th>Most Entries</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for contest in contests %}
              <tr class="table-row" data-contest-url="{% url 'contest_manager' %}">
                <td>
                  <div class="contest-name">
                    <div class="contest-name-header">
                      <div class="contest-toggle-container">
                        <label class="toggle-switch">
                          <input type="checkbox" 
                                 class="contest-toggle" 
                                 data-contest-id="{{ contest.contest_id }}"
                                 {% if contest.is_active %}checked{% endif %}
                                 onchange="toggleContestStatus(this)">
                          <span class="toggle-slider"></span>
                        </label>
                      </div>
                      <div class="contest-name-content">
                        <strong>{{ contest.name }}</strong>
                        <div class="contest-dates">{{ contest.starts_at|date:"M d, Y" }} - {{ contest.ends_at|date:"M d, Y" }}</div>
                      </div>
                    </div>
                  </div>
                </td>
                <td>
                  <div class="spending-info">
                    <span class="spending-amount">RM{{ contest.min_purchase_amount|default:"0.00" }}</span>
                    <div class="spending-detail">minimum purchase</div>
                  </div>
                </td>
                <td>
                  <div class="products-list">
                    <div class="product-item">Contest Products</div>
                    <div class="product-item">Various Items</div>
                  </div>
                </td>
                <td>
                  <div class="stores-list">
                    <div class="store-item">Participating Stores</div>
                    <div class="store-item">Multiple Locations</div>
                  </div>
                </td>
                <td>
                  <div class="locations-list">
                    <div class="location-item">All States</div>
                    <div class="location-item">Nationwide</div>
                  </div>
                </td>
                <td>
                  <div class="entries-info">
                    <span class="entries-count">{{ contest.total_entries }}</span>
                    <div class="entries-detail">total entries</div>
                  </div>
                </td>
                <td>
                  {% if contest.is_active %}
                    <span class="status-badge active">ACTIVE</span>
                  {% else %}
                    <span class="status-badge ended">INACTIVE</span>
                  {% endif %}
                </td>
                <td>
                  <div class="action-buttons">
                    <a href="{% url 'contest_detail' contest.contest_id %}" class="btn btn-primary btn-sm">View Details</a>
                  </div>
                </td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="8" class="text-center">No contests found</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
      </div>
    {% else %}
      <!-- Empty State -->
      <div class="empty-state">
        <div class="empty-state-icon">🏆</div>
        <h2 class="empty-state-title">No Contests Yet</h2>
        <p class="empty-state-text">
          Create your first contest to start collecting entries and engaging with customers through WhatsApp.
        </p>
        <a href="{% url 'contest_create' %}" class="btn btn-primary">
          Create Your First Contest
        </a>
      </div>
    {% endif %}
    </div>
  </div>

  <script>
    // Toggle contest status functionality
    function toggleContestStatus(toggleElement) {
      const contestId = toggleElement.getAttribute('data-contest-id');
      const isActive = toggleElement.checked;
      
      // Disable the toggle while processing
      toggleElement.disabled = true;
      
      // Get CSRF token from meta tag or cookie
      const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]')?.value || getCookie('csrftoken');
      
      // Make AJAX request
      fetch('{% url "toggle_contest_status" %}', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'X-CSRFToken': csrfToken
        },
        body: JSON.stringify({
          contest_id: contestId,
          is_active: isActive
        })
      })
      .then(response => response.json())
      .then(data => {
        if (data.success) {
          // Update status badge
          const row = toggleElement.closest('tr');
          const statusBadge = row.querySelector('.status-badge');
          if (statusBadge) {
            if (isActive) {
              statusBadge.textContent = 'ACTIVE';
              statusBadge.className = 'status-badge active';
            } else {
              statusBadge.textContent = 'INACTIVE';
              statusBadge.className = 'status-badge ended';
            }
          }
          
          // Show success message
          showNotification(data.message, 'success');
        } else {
          // Revert toggle state on error
          toggleElement.checked = !isActive;
          showNotification(data.error || 'Failed to update contest status', 'error');
        }
      })
      .catch(error => {
        // Revert toggle state on error
        toggleElement.checked = !isActive;
        showNotification('Network error. Please try again.', 'error');
        console.error('Error:', error);
      })
      .finally(() => {
        // Re-enable the toggle
        toggleElement.disabled = false;
      });
    }
    
    // Get CSRF token from cookies
    function getCookie(name) {
      let cookieValue = null;
      if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
          const cookie = cookies[i].trim();
          if (cookie.substring(0, name.length + 1) === (name + '=')) {
            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
            break;
          }
        }
      }
      return cookieValue;
    }
    
    // Show notification
    function showNotification(message, type = 'info') {
      // Create notification element
      const notification = document.createElement('div');
      notification.className = `notification notification-${type}`;
      notification.textContent = message;
      
      // Add styles
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 12px 20px;
        border-radius: 8px;
        color: white;
        font-weight: 500;
        z-index: 10000;
        max-width: 300px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        transform: translateX(100%);
        transition: transform 0.3s ease;
      `;
      
      // Set background color based on type
      if (type === 'success') {
        notification.style.backgroundColor = '#42b883';
      } else if (type === 'error') {
        notification.style.backgroundColor = '#e74c3c';
      } else {
        notification.style.backgroundColor = '#17a2b8';
      }
      
      // Add to page
      document.body.appendChild(notification);
      
      // Animate in
      setTimeout(() => {
        notification.style.transform = 'translateX(0)';
      }, 100);
      
      // Remove after 3 seconds
      setTimeout(() => {
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => {
          if (notification.parentNode) {
            notification.parentNode.removeChild(notification);
          }
        }, 300);
      }, 3000);
    }
    
    // Handle row clicks and prevent toggle clicks from triggering row navigation
    document.addEventListener('DOMContentLoaded', function() {
      // Handle row clicks
      const tableRows = document.querySelectorAll('.table-row');
      tableRows.forEach(row => {
        row.addEventListener('click', function(e) {
          // Don't navigate if clicking on toggle or action buttons
          if (e.target.closest('.contest-toggle-container') || 
              e.target.closest('.action-buttons')) {
            return;
          }
          
          const contestUrl = row.getAttribute('data-contest-url');
          if (contestUrl) {
            window.location.href = contestUrl;
          }
        });
      });
      
      // Prevent toggle clicks from triggering row navigation
      const toggleContainers = document.querySelectorAll('.contest-toggle-container');
      toggleContainers.forEach(container => {
        container.addEventListener('click', function(e) {
          e.stopPropagation();
        });
      });
    });
  </script>
</body>
</html>
