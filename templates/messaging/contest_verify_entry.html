<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Verify Entry - {{ entry.customer.name }}</title>

  <style>
    /* ===== Modern Verification Design ===== */
    :root{
      --primary:#1877f2; --primary-hover:#166fe5; --primary-light:#e7f3ff;
      --secondary:#42b883; --secondary-hover:#3aa876; --secondary-light:#e8f5e8;
      --success:#42b883; --warning:#f7b731; --danger:#e74c3c; --info:#17a2b8;
      --gray:#f0f2f5; --gray-dark:#65676b; --gray-light:#f8f9fa;
      --white:#ffffff; --black:#1c1e21; --text:#1c1e21;
      --border:#dadde1; --shadow:0 2px 4px rgba(0,0,0,0.1), 0 8px 16px rgba(0,0,0,0.1);
      --radius:8px; --radius-lg:12px;
    }
    *{box-sizing:border-box; margin:0; padding:0}
    body{background:var(--gray); color:var(--text); font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif; line-height:1.4}

    /* ===== Top Navigation ===== */
    .topbar{
      background:var(--white); border-bottom:1px solid var(--border);
      position:sticky; top:0; z-index:1000; box-shadow:0 1px 2px rgba(0,0,0,0.1)
    }
    .topbar__inner{
      max-width:1200px; margin:0 auto; display:flex; align-items:center; justify-content:space-between;
      padding:8px 16px; height:56px
    }
    .brand{
      display:flex; align-items:center; gap:8px; text-decoration:none; font-weight:700; font-size:20px
    }
    .brand__logo{
      width:40px; height:40px; border-radius:50%; background:var(--primary);
      display:flex; align-items:center; justify-content:center; color:white; font-weight:800
    }
    .brand__text{color:var(--text)}

    .nav-tabs{
      display:flex; gap:8px; align-items:center; flex:1; justify-content:center
    }
    .nav-tab{
      padding:8px 16px; border-radius:var(--radius); text-decoration:none; font-weight:600;
      color:var(--gray-dark); transition:all 0.2s; position:relative
    }
    .nav-tab:hover{background:var(--gray-light); color:var(--text)}
    .nav-tab.active{color:var(--primary); background:var(--primary-light)}

    .user-menu{
      display:flex; align-items:center; gap:12px
    }
    .user-avatar{
      width:32px; height:32px; border-radius:50%; background:var(--primary);
      display:flex; align-items:center; justify-content:center; color:white; font-weight:600
    }

    /* ===== Main Content ===== */
    .main-content{
      max-width:800px; margin:0 auto; padding:24px 16px
    }

    /* ===== Page Header ===== */
    .page-header{
      display:flex; justify-content:space-between; align-items:center; margin-bottom:24px
    }
    .page-title{
      font-size:28px; font-weight:700; color:var(--text)
    }
    .btn{
      padding:10px 20px; border-radius:var(--radius); text-decoration:none; font-weight:600;
      transition:all 0.2s; border:none; cursor:pointer; display:inline-flex; align-items:center; gap:8px
    }
    .btn-secondary{
      background:var(--gray-dark); color:white
    }
    .btn-secondary:hover{background:var(--text); color:white}

    /* ===== Verification Form ===== */
    .verification-container{
      background:var(--white); border-radius:var(--radius-lg); padding:32px; box-shadow:var(--shadow);
      border:1px solid var(--border)
    }

    .entry-info{
      background:var(--gray-light); border-radius:var(--radius); padding:20px; margin-bottom:24px
    }
    .entry-header{
      display:flex; justify-content:space-between; align-items:center; margin-bottom:16px
    }
    .entry-title{
      font-size:20px; font-weight:700; color:var(--text)
    }
    .status-badge{
      padding:6px 16px; border-radius:20px; font-size:14px; font-weight:600; text-transform:uppercase
    }
    .status-pending{background:var(--warning); color:white}
    .status-submitted{background:var(--info); color:white}
    .status-verified{background:var(--success); color:white}
    .status-rejected{background:var(--danger); color:white}

    .info-grid{
      display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:16px
    }
    .info-item{
      display:flex; flex-direction:column; gap:4px
    }
    .info-label{
      font-size:12px; font-weight:600; color:var(--gray-dark); text-transform:uppercase
    }
    .info-value{
      font-size:16px; color:var(--text)
    }

    /* ===== Form Styles ===== */
    .form-group{
      margin-bottom:20px
    }
    .form-label{
      display:block; font-weight:600; color:var(--text); margin-bottom:8px
    }
    .form-textarea{
      width:100%; padding:12px 16px; border:1px solid var(--border); border-radius:var(--radius);
      font-size:16px; min-height:100px; resize:vertical; font-family:inherit
    }
    .form-textarea:focus{
      outline:none; border-color:var(--primary); box-shadow:0 0 0 3px var(--primary-light)
    }

    .form-actions{
      display:flex; gap:12px; justify-content:flex-end; margin-top:32px; padding-top:24px;
      border-top:1px solid var(--border)
    }
    .btn-primary{
      background:var(--primary); color:white; padding:12px 24px; font-size:16px
    }
    .btn-primary:hover{background:var(--primary-hover); color:white}
    .btn-success{
      background:var(--success); color:white; padding:12px 24px; font-size:16px
    }
    .btn-success:hover{background:var(--secondary-hover); color:white}
    .btn-danger{
      background:var(--danger); color:white; padding:12px 24px; font-size:16px
    }
    .btn-danger:hover{background:#c0392b; color:white}

    /* ===== Receipt Section ===== */
    .receipt-section{
      background:var(--gray-light); border-radius:var(--radius); padding:20px; margin-bottom:24px
    }
    .receipt-title{
      font-size:18px; font-weight:700; color:var(--text); margin-bottom:12px
    }
    .receipt-image{
      max-width:100%; height:auto; border-radius:var(--radius); border:1px solid var(--border)
    }
    .receipt-details{
      margin-top:12px; display:grid; grid-template-columns:repeat(auto-fit, minmax(150px, 1fr)); gap:12px
    }

    /* ===== Responsive ===== */
    @media (max-width: 768px){
      .info-grid{grid-template-columns:1fr}
      .form-actions{flex-direction:column}
      .entry-header{flex-direction:column; align-items:flex-start; gap:8px}
    }
  </style>
</head>
<body>
  <!-- Top Navigation -->
  <div class="topbar">
    <div class="topbar__inner">
      <a href="{% url 'contest_home' %}" class="brand">
        <div class="brand__logo">W</div>
        <span class="brand__text">WhatsApp Contest</span>
      </a>
      
      <div class="nav-tabs">
        <a href="{% url 'contest_home' %}" class="nav-tab active">Contest</a>
        <a href="{% url 'crm_home' %}" class="nav-tab">CRM</a>
        <a href="{% url 'manage_customers' %}" class="nav-tab">Customers</a>
      </div>
      
      <div class="user-menu">
        <div class="user-avatar">{{ user.username|first|upper }}</div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Page Header -->
    <div class="page-header">
      <h1 class="page-title">Verify Contest Entry</h1>
      <a href="{% url 'contest_detail' contest.contest_id %}" class="btn btn-secondary">
        ‚Üê Back to Contest
      </a>
    </div>

    <!-- Verification Form -->
    <form method="post" class="verification-container">
      {% csrf_token %}
      
      <!-- Entry Information -->
      <div class="entry-info">
        <div class="entry-header">
          <h2 class="entry-title">{{ entry.customer.name }}</h2>
          <span class="status-badge status-{{ entry.status }}">
            {{ entry.get_status_display }}
          </span>
        </div>
        
        <div class="info-grid">
          <div class="info-item">
            <span class="info-label">Phone Number</span>
            <span class="info-value">{{ entry.contestant_phone|default:entry.customer.phone_number }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">NRIC</span>
            <span class="info-value">{{ entry.contestant_nric|default:"Not provided" }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Submitted</span>
            <span class="info-value">{{ entry.submitted_at|date:"M d, Y H:i" }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Contest</span>
            <span class="info-value">{{ entry.contest.name }}</span>
          </div>
        </div>
      </div>

      <!-- Receipt Information -->
      {% if entry.receipt_image_url %}
        <div class="receipt-section">
          <h3 class="receipt-title">üì∏ Receipt/Proof of Purchase</h3>
          <img src="{{ entry.receipt_image_url }}" alt="Receipt" class="receipt-image">
          {% if entry.receipt_amount or entry.receipt_store %}
            <div class="receipt-details">
              {% if entry.receipt_amount %}
                <div class="info-item">
                  <span class="info-label">Amount</span>
                  <span class="info-value">RM {{ entry.receipt_amount }}</span>
                </div>
              {% endif %}
              {% if entry.receipt_store %}
                <div class="info-item">
                  <span class="info-label">Store</span>
                  <span class="info-value">{{ entry.receipt_store }}</span>
                </div>
              {% endif %}
            </div>
          {% endif %}
        </div>
      {% endif %}

      <!-- Verification Notes -->
      <div class="form-group">
        <label for="verification_notes" class="form-label">Verification Notes</label>
        <textarea id="verification_notes" name="verification_notes" class="form-textarea" 
                  placeholder="Add notes about this verification...">{{ entry.verification_notes|default:"" }}</textarea>
      </div>

      <!-- Form Actions -->
      <div class="form-actions">
        <a href="{% url 'contest_detail' contest.contest_id %}" class="btn btn-secondary">Cancel</a>
        
        {% if entry.status != 'verified' %}
          <button type="submit" name="action" value="verify" class="btn btn-success">
            ‚úÖ Verify Entry
          </button>
        {% endif %}
        
        {% if entry.status != 'rejected' %}
          <button type="submit" name="action" value="reject" class="btn btn-danger">
            ‚ùå Reject Entry
          </button>
        {% endif %}
      </div>
    </form>
  </div>

  <script>
    // Confirmation dialogs
    document.querySelector('button[value="verify"]').addEventListener('click', function(e) {
      if (!confirm('Are you sure you want to verify this entry? This will send an eligibility message to the contestant.')) {
        e.preventDefault();
      }
    });

    document.querySelector('button[value="reject"]').addEventListener('click', function(e) {
      if (!confirm('Are you sure you want to reject this entry?')) {
        e.preventDefault();
      }
    });
  </script>
</body>
</html>

